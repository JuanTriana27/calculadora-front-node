<div class="calculadora-container">
    <!-- Pantalla -->
    <div class="pantalla">
        <div class="expresion" [class.error]="errorMessage">
            {{ expression || '0' }}
        </div>
        <div class="resultado" [class.error]="errorMessage">
            {{ getDisplayFormatted() }}
        </div>

        @if (isCalculating) {
        <div class="calculando">
            <i class="fas fa-spinner fa-spin"></i>
            <span>Calculando...</span>
        </div>
        }
    </div>

    <!-- Teclado -->
    <div class="teclado">
        <!-- Primera fila - Funciones -->
        <div class="fila">
            <button class="btn btn-funcion btn-clear" (click)="clear()" title="Limpiar">
                AC
            </button>
            <button class="btn btn-funcion" (click)="deleteLast()" title="Borrar último">
                <i class="fas fa-backspace"></i>
            </button>
            <button class="btn btn-funcion" (click)="porcentaje()" title="Porcentaje">
                %
            </button>
            <button class="btn btn-operador" (click)="appendOperator('÷')" title="Dividir">
                ÷
            </button>
        </div>

        <!-- Segunda fila -->
        <div class="fila">
            <button class="btn btn-numero" (click)="appendNumber('7')">
                7
            </button>
            <button class="btn btn-numero" (click)="appendNumber('8')">
                8
            </button>
            <button class="btn btn-numero" (click)="appendNumber('9')">
                9
            </button>
            <button class="btn btn-operador" (click)="appendOperator('×')" title="Multiplicar">
                ×
            </button>
        </div>

        <!-- Tercera fila -->
        <div class="fila">
            <button class="btn btn-numero" (click)="appendNumber('4')">
                4
            </button>
            <button class="btn btn-numero" (click)="appendNumber('5')">
                5
            </button>
            <button class="btn btn-numero" (click)="appendNumber('6')">
                6
            </button>
            <button class="btn btn-operador" (click)="appendOperator('-')" title="Restar">
                -
            </button>
        </div>

        <!-- Cuarta fila -->
        <div class="fila">
            <button class="btn btn-numero" (click)="appendNumber('1')">
                1
            </button>
            <button class="btn btn-numero" (click)="appendNumber('2')">
                2
            </button>
            <button class="btn btn-numero" (click)="appendNumber('3')">
                3
            </button>
            <button class="btn btn-operador" (click)="appendOperator('+')" title="Sumar">
                +
            </button>
        </div>

        <!-- Quinta fila -->
        <div class="fila">
            <button class="btn btn-numero btn-cero" (click)="appendNumber('0')">
                0
            </button>
            <button class="btn btn-numero" (click)="appendDecimal()" title="Punto decimal">
                .
            </button>
            <button class="btn btn-igual" (click)="calculate()" title="Calcular">
                =
            </button>
        </div>
    </div>

    <!-- Botón de historial -->
    <div class="historial-btn-container">
        <button class="btn-historial" routerLink="/historial">
            <i class="fas fa-history"></i>
            <span>Ver Historial</span>
        </button>
    </div>
</div>